{% load static %}
<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <!-- Metas -->
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="keywords" content="" />
  <meta name="description" content="" />
  <meta name="author" content="@toxsltech">
  <!-- Title -->
  <title> spaceand Fido</title>
  <!-- Favicon -->
  <link rel="shortcut icon" href="{% static 'admin-assets/images/fav.ico' %}" />
  <!-- Bootstrap Css -->
  <link rel="stylesheet" href="{% static 'admin-assets/css/bootstrap.min.css' %}" />
  <!-- Plugins -->
  <link rel="stylesheet" href="{% static 'admin-assets/css/helpers-plugin.css' %}" />
  <!-- fontawesome Css -->
  <link rel="stylesheet" href="{% static 'admin-assets/fonts/fontawesome/css/all.min.css' %}" />

  <!-- Slick Slider -->
  <link rel="stylesheet" href="{% static 'admin-assets/css/slick-theme.css' %}" />
  <link rel="stylesheet" href="{% static 'admin-assets/css/slick.css' %}" />

  <!-- Style Css -->
  
  <link rel="stylesheet" href="{% static 'admin-assets/css/style.css' %}" />
  <link rel="stylesheet" href="{% static 'admin-assets/rvt-css/common-style.css' %}" />
  <!-- jquery JS -->
  <script src="{% static 'admin-assets/js/jquery.js' %}"></script>
  <!-- bootstrap JS -->
  <script src="{% static 'admin-assets/js/bootstrap.bundle.min.js' %}"></script>
  <script src="{% static 'admin-assets/js/moment.min.js' %}"></script>
  <link rel="stylesheet" href="{% static 'admin-assets/css/flash.css' %}" />
 

  <!-- Slick -->
  <script src="{% static 'admin-assets/js/slick.min.js' %}"></script>
  <link rel="stylesheet" href="{% static 'admin-assets/css/slick-theme.css' %}" />
  <link rel="stylesheet" href="{% static 'admin-assets/css/slick.css' %}" />
  
  <style>
    #card_err {        
      color: red !important    
      }
  </style>

<style>
  .alert_dot1{
    width: 10px;
    height: 10px;
    background-color: #fb9a00;
    border: 2px solid #f1f1fb;
    position: absolute;
    display: inline-block;
    z-index: 1;
    border-radius: 50%;
    right: -3px;
    top: -2px;
  }
</style>

  


  <style>
  .alert_dot1{
    width: 10px;
    height: 10px;
    background-color: #fb9a00;
    border: 2px solid #f1f1fb;
    position: absolute;
    display: inline-block;
    z-index: 1;
    border-radius: 50%;
    right: -3px;
    top: -2px;
  }
</style>

</head>

<body>
  <!-- Start Page Wrapper -->
  <main class="page-wrapper">

    <div id="sidebar" class="navbar-nav-left sidebar">
      <nav class="navbar navbar-expand-xl">
        <button id="nav-icon2" class="navbar-toggler mobile-menu d-xl-none" type="button" data-toggle="collapse"
          data-target="#sidebar-nav" aria-controls="sidebar-nav" aria-expanded="false" aria-label="Toggle navigation">
          <i class="fal fa-times-circle"></i>
        </button>
        <a class="navbar-brand" href="">
          <img src="{% static 'admin-assets/images/logo.png' %}">
        </a>
        <div class="collapse navbar-collapse" id="sidebar-nav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link {% if  nbar == '' %} active {% endif %}" href="{% url 'enduser:user_dashboard' %}"><img
                  src="{% static 'admin-assets/images/icons/dash.svg' %}">Dashboard</a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if nbar == 'user_my_appointments' %} active {% endif %}"
                href="{% url 'enduser:user_appointments' %}"><img
                  src="{% static 'admin-assets/images/icons/appointment-user.svg' %}">Appointments</a>
            </li>

            <li class="nav-item">
              <a class="nav-link {% if nbar == 'user_chat' %} active {% endif %}" href="{% url 'enduser:users_chat_list' %}"><img
                  src="{% static 'admin-assets/images/icons/inbox.svg' %}">Messages</a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if nbar == 'settings' %} active {% endif %}" href="{% url 'enduser:user_profile' %}"><img
                  src="{% static 'admin-assets/images/icons/services.svg' %}">Settings</a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if nbar == 'payments' %} active {% endif %}"  href="{% url 'enduser:user_payment'%}">
                <img src="{% static 'admin-assets/images/icons/transaction.png' %}">Payments</a>
            </li>
          </ul>
          {% comment %} <div class="sidebar-extra-wrap">
            <div class="button-wrap">
              <a href="#" class="btn btn-theme btn-rounded w-100">
                <img src="{% static 'admin-assets/images/rvt/order-supply.svg' %}" alt=""> Order Supply
              </a>
            </div>
            <div class="app-download">
              {% comment %} <h4>Download our apps now !</h4> {% endcomment %}
              <h4> Apps launching soon!!</h4>
              <div class="app-icon-wrap">
                <a href="" class="app-icon">
                  <img src="{% static 'admin-assets/images/icons/android.svg' %}" alt="">
                </a>
                <a href="" class="app-icon">
                    <img src="{% static 'admin-assets/images/icons/ios.svg' %}" alt="">
                </a>
              </div>
            </div>
          </div> {% endcomment %}
        </div>
      </nav>
    </div>
    {% if messages %}
    <div class="flash animate--drop-in-fade-out">
    {% for message in messages %}
        <div class="flash__icon">
            <i class="icon far fa-check-circle"></i>
        </div>
        <p class="flash__body">
            {{ message }}
        </p>
        {% endfor %}
    </div>
    {% endif %}
    <div id="content-wrapper" class="main-site-wrap media-body">
      <header class="header-main">
        <div class="d-flex align-items-center w-100">
          <div class="header-left">
            <div class="d-flex align-items-center">
              <button id="nav-icon2" class="navbar-toggler mobile-menu d-xl-none" type="button" data-toggle="collapse"
                data-target="#sidebar-nav" aria-controls="sidebar-nav" aria-expanded="false"
                aria-label="Toggle navigation">
                <div class="bar-one"></div>
                <div class="bar-two"></div>
                <div class="bar-three"></div>
              </button>
              {% if title == "Site administration" %}
              <h2>Dashboard</h2>
              {% else %}
              <h2>{{title}}</h2>
              {% endif %}
            </div>
          </div>
          <div class="header-right media-body">
            <div class="d-flex justify-content-end align-items-center">
              <div class="header-small-menu d-none d-lg-inline-block">
                <a href="{% url 'enduser:users_chat_list' %}">
                  <img src="{% static 'admin-assets/images/rvt/messages.svg' %}">
                 <span class="alert-dot"></span> 
                </a>
                <a href="{% url 'enduser:help_user' %}">
                  <img src="{% static 'admin-assets/images/rvt/help.svg' %}">
                </a>
                <span class="dropdown notification-dropdown">
                  <button class="dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown"
                    aria-haspopup="true" aria-expanded="false">
                    <img src="{% static 'admin-assets/images/rvt/notifications.svg' %}">
                    <span class="alert_dot1"></span>
                  </button>
                  <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton">
                    <div class="nav-notification-header text-center">
                      <h4 class="mb-0">Notification </h4>
                    </div>
                    <div class="nav-notification-body">
                      <ul class="nav-list-items" id= 't-d-bodys'>
                      </ul>
                        
                      
                    </div>
                  </div>
                </span>
              </div>
              <div class="profile-dropdown dropdown">
                <button class="btn btn-secondary dropdown-toggle d-flex" type="button" id="dropdownProfileButton"
                  data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  {% if request.user.profile_pic %}
                  <img src="{{request.user.profile_pic.url}}" alt="">
                  {% else %}
                  <img src="{% static 'admin-assets/images/default.png' %}" alt="">
                  {% endif %}
                  <div class="media-body">
                    <p>{{request.user.first_name}}</p>
                    <span>{{request.user.email}}</span>
                  </div>
                </button>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownProfileButton">
                  <form onsubmit="Loader(this.id)" action="{% url 'enduser:user_status_change' %}" method="POST">
                    <div class="checkbox-wrap switch-button d-flex align-items-center">
                        <input type="hidden" value="{{request.user.id}}" name="user_id">
                        {% csrf_token %}
                        <div class="form-check">
                          <input type="radio" class="form-check-input" id="active" name="state" {% if request.user.status == True %}checked{% endif %} onchange="this.form.submit()">
                          <label class="form-check-label" for="active">Active</label>
                        </div>
                        <div class="form-check">
                          <input type="radio" class="form-check-input" id="inactive" name="state" {% if request.user.status == False %}checked{% endif %} onchange="this.form.submit()">
                          <label class="form-check-label" for="inactive" >Inactive</label>
                        </div>
                    </div>
                  </form>
  
                  <a class="dropdown-item" id="getuser" href="{% url 'enduser:change_to_rvt' %}"><img src="{% static 'admin-assets/images/rvt/switch.png' %}" alt="">
                    RVT Profile</a>
                  <a class="dropdown-item" href="{% url 'enduser:user_profile' %}"><img src="{% static 'admin-assets/images/rvt/setting.png' %}" alt="">
                    Settings</a>
                  <a class="dropdown-item" href="{% url 'accounts:logout' %}"><img
                      src="{% static 'admin-assets/images/rvt/logout.png' %}" alt=""> Log out</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </header>
      <div class="main-content-inner">
      <script>

      $.get("{% url 'frontend:user_check_rvt' %}",{user_id:"{{request.user.id}}"}).done(function(data){
      let result = data["is_user"]
           if (result == "true"){
              $('#getuser').css('display','none');
            }
          else{
            $('#getuser').css('display','block');
        }   
      })
      </script>



<script>
    function ConvertGTime(createdate, createtime) {
        var d = createdate + "T" + createtime + "Z";
        const date = d;
        const local = moment.utc(date).local().format("Do MMM  YYYY hh:mm A");
        return local;
    }
</script>

<script>
  let user_interval = 60000;
  var intervalId;
  var mainintervalId;
 $(".alert_dot1").css('display','none')
    $("#dropdownMenuButton").ready(function(){
      var timesRun = 0;
        mainintervalId = setInterval(function(){
        timesRun += 1;
        if(timesRun){
      $.ajax({
        url : "{% url 'enduser:notification_display_user' %}",
        type : 'GET',
        success:function(data){
        if(data["created_for"].length > 0){
          $('#t-d-bodys').html('')
           for (let i=0;  i < data.title.length; i++){
            if (data['image'][i]){
              var image = data['image'][i]
          }
          else{
              var image ="/static/admin-assets/images/default.png"
           }
           var is_read = data['is_read'][i]
              if(is_read==1){
              $(".alert_dot1").css('display','none')
              }
              else{
                $(".alert_dot1").css('display','block')
              }
              var title = data['title'][i]
              var created_for = data['created_for'][i]
              var descriptionn = data['description'][i]
              var time = data['created_on'][i]
              let date = time
              let html = `
              <li class="notifications-list d-md-flex align-items-center" >
                <div class="icon-wrap">
                  <img src="`+image+`" class="rounded-circle object-cover border" alt="" />
                </div>
                <div class="media-body pl-0 pl-md-20 pt-10 pt-md-0 mb-10 mb-md-0" >
                  <h4 class="text-primary font-15 font_400"  >`+title+`</h4>
                  <p class="pl-0 ml-0">`+descriptionn+`</p>
                </div>
                <div class="date text-right align-self-start" >`+time+`</div>
              </li>
              `
              $('#t-d-bodys').append(html)
             }
             let html2=`<div class="nav-notification-footer" >
              <a href="{% url 'enduser:all_notifications_user'%}">See all notifications</a>
            </div>`
            $('#t-d-bodys').append(html2)
          }
    else{
      let html3=`<div class="media-body pl-0 pl-md-20 pt-10 pt-md-0 mb-10 mb-md-0" >
        <h4 class="text-primary font-15 font_400"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;No Notifications Found</h4>
      </div>`
      $('#t-d-bodys').html(html3)
    }
  }
})
intervalId = setInterval(user_interval);
}else{
clearInterval(intervalId);
clearInterval(mainintervalId);
}
},2000)

})
  </script> 
  
